<!DOCTYPE html>
<html>
<head>
	<title>Userpatch Patch Notes</title>
	<meta charset="utf-8"/>
	<link rel="stylesheet" type="text/css" href="../../css/style.css">
	<link rel="stylesheet" type="text/css" href="../../jqueryui/jquery-ui.min.css">
	<link rel="stylesheet" type="text/css" href="../../jqueryui/jquery-ui.structure.min.css">
	<link rel="stylesheet" type="text/css" href="../../jqueryui/jquery-ui.theme.min.css">
	<link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css2?family=Crimson+Text&display=swap" rel="stylesheet"> 
    <link rel="icon" type="image/png" href="../../../favicon.png">
</head>

<body>

	<div class="container">
		<div id="nav-placeholder"></div>
		<h2>Userpatch Patch Notes</h2><p>
			<label for="patchNotesInput" class="patch-notes-input-label">Search</label>
			<label for="patchNotesVersion" class="dropdown-label">Version</label>
			<label for="patchNotesYear" class="dropdown-label">Year</label>
			<label for="patchNotesMonth" class="dropdown-label">Month</label>
			<label for="patchNotesType" class="dropdown-label">Release Type</label>
			<input type="text" id="patchNotesInput" onkeyup="patchNotesFilter()" placeholder="Search patch notes..." autocomplete="off" autofocus="autofocus">
			<select id="patchNotesVersion" class="drop-filter" onchange="patchNotesFilter()" autocomplete="off" title="UP Version">
				<option value="All" selected>All</option>
				<option value="1.1">1.1</option>
				<option value="1.2">1.2</option>
				<option value="1.3">1.3</option>
				<option value="1.4">1.4</option>
				<option value="1.5">1.5</option>
			</select>
			<select id="patchNotesYear" class="drop-filter" onchange="patchNotesFilter()" autocomplete="off" title="Year">
				<option value="All" selected>All</option>
				<option value="2011">2011</option>
				<option value="2012">2012</option>
				<option value="2013">2013</option>
				<option value="2014">2014</option>
				<option value="2015">2015</option>
				<option value="2016">2016</option>
				<option value="2017">2017</option>
				<option value="2018">2018</option>
				<option value="2019">2019</option>
			</select>
			<select id="patchNotesMonth" class="drop-filter" onchange="patchNotesFilter()" autocomplete="off" title="Month">
				<option value="All" selected>All</option>
				<option value="1">January</option>
				<option value="2">February</option>
				<option value="3">March</option>
				<option value="4">April</option>
				<option value="5">May</option>
				<option value="6">June</option>
				<option value="7">July</option>
				<option value="8">August</option>
				<option value="9">September</option>
				<option value="10">October</option>
				<option value="11">November</option>
				<option value="12">December</option>
			</select>
			<select id="patchNotesType" class="drop-filter" onchange="patchNotesFilter()" autocomplete="off" title="Scripting Type">
				<option value="All" selected>All</option>
				<option value="ai">AI</option>
				<option value="rms">RMS</option>
				<option value="other">Other</option>
			</select>
		</p>
		<p id="num-results"></p>
		<p id="patchNotesTable"></p>
		<div id="footer-placeholder"></div>
	</div>
	
	<script>
		var urlPrefix = "../.."; //this adds a prefix to all reference links so the link knows the path to the home directory
		var currPage = "resources";
	</script>
	<script src="../../js/upreleases.js"></script>
	<script src="../../js/nav.js"></script>
	<script src="../../js/jquery.js"></script>
	<script src="../../jqueryui/jquery-ui.min.js"></script>

	<script>
		/*function patchNotesFilter() {
			var num = 0;
			var text = "";
			var hasReleases = false;

			// Declare variables
			var input, version, year, month, type, filter
			input = document.getElementById("patchNotesInput");
			version = document.getElementById("patchNotesVersion");
			year = document.getElementById("patchNotesYear");
			month = document.getElementById("patchNotesMonth");
			type = document.getElementById("patchNotesType");
			var notes = "";
			filter = input.value.toUpperCase();

			for(var i = 0; i < releaseVersions.length; i++) {
				if(version.value == releaseVersions[i] || version.value == "All") {
					text += "<h2 id=\"version-header-" + i + "\" class=\"patch-notes-header, patch-notes-version\">Version " + releaseVersions[i] + "</h2>";
					for(var j = 0; j < releaseYears.length; j++) {
						if(year.value == releaseYears[j] || year.value == "All") {
							for(var q = 0; q < releaseNotes.length; q++) {
								if(releaseNotes[q].version == releaseVersions[i] && releaseNotes[q].year == releaseYears[j]) {
									hasReleases = true;
									text += "<h3 id=\"year-header-" + j + "\" class=\"patch-notes-header, patch-notes-year\">" + releaseYears[j] + "</h3>";
									break;
								}
							}
							if (hasReleases) {
								hasReleases = false
								for(var k = releaseMonths.length - 1; k >= 0; k--) {
									if(month.value == k || month.value == "All") {
										for(var p = 0; p < releaseNotes.length; p++) {
											notes = releaseNotes[p].notes.toString();
											notes = notes.toUpperCase();
											if(releaseNotes[p].version == releaseVersions[i] && releaseNotes[p].year == releaseYears[j] && releaseNotes[p].month == k && notes.indexOf(filter) > -1) {
												hasReleases = true;
												text += "<h3 id=\"month-header-" + k + "\" class=\"patch-notes-header, patch-notes-month\">" + releaseMonths[k - 1] + "</h3>";
												text += "<table class=\"patch-table\"><tr><th class=\"patch-notes-version-col\">Version</th><th class=\"patch-notes-release-col\">Release</th><th class=\"patch-notes-type-col\">Type</th><th class=\"patch-notes-description-col\">Description</th></tr>";
												break;
											}
										}
										if(hasReleases) {
											for(var m = 0; m < releaseNotes.length; m++) {
												notes = releaseNotes[m].notes.toString();
												notes = notes.toUpperCase();
												if(releaseNotes[m].version == releaseVersions[i] && releaseNotes[m].year == releaseYears[j] && releaseNotes[m].month == k && (releaseNotes[m].scriptingType == type.value || type.value == "All" &&notes.indexOf(filter) > -1)) {
													text += "<tr><td>" + releaseNotes[m].version + "</td>";
													text += "<td>" + releaseNotes[m].number + "</td>";
													if(releaseNotes[m].scriptingType == "ai") {
														text += "<td>AI</td>";
													}
													else if (releaseNotes[m].scriptingType == "rms") {
														text += "<td>RMS</td>";
													}
													else {
														text += "<td>Other</td>";
													}
													text += "<td>" + releaseNotes[m].notes;
													if (releaseNotes[m].itemsAffected.length > 0) {
														text += "<br><strong>Items Affected: </strong>";
														for(var n = 0; n < releaseNotes[m].itemsAffected.length; n++) {
															text += releaseNotes[m].itemsAffected[n].getLink();
															if (n < releaseNotes[m].itemsAffected.length - 1) {
																text += ", ";
															}
														}
													}
													text += "</td></tr>";
													num = num + 1;
												}
											}
											text += "</table>";
										}
									}
								}
								text += "<hr>";
								hasReleases = false;
							}
						}
					}
				}
			}
			document.getElementById("patchNotesTable").innerHTML = text;
			document.getElementById("num-results").innerHTML = "Num Results: " + num;
		}*/
	</script>

	<script>
		var num = 0;
		var text = "";
		var hasReleases = false;

		for(var i = 0; i < releaseVersions.length; i++) {
			text += "<h2 id=\"version-header-" + i + "\" class=\"patch-notes-header, patch-notes-version\">Version " + releaseVersions[i] + "</h2>";
			for(var j = 0; j < releaseYears.length; j++) {
				for(var k = 0; k < releaseNotes.length; k++) {
					if(releaseNotes[k].version == releaseVersions[i] && releaseNotes[k].year == releaseYears[j]) {
						hasReleases = true;
						text += "<h3 id=\"year-header-" + j + "\" class=\"patch-notes-header, patch-notes-year\">" + releaseYears[j] + "</h3>";
						break;
					}
				}
				if (hasReleases) {
					hasReleases = false;
					for(var m = releaseMonths.length - 1; m >= 0; m--) {
						for(var n = 0; n < releaseNotes.length; n++) {
							if(releaseNotes[n].version == releaseVersions[i] && releaseNotes[n].year == releaseYears[j] && releaseNotes[n].month == m) {
								hasReleases = true;
								text += "<h3 id=\"month-header-" + m + "\" class=\"patch-notes-header, patch-notes-month\">" + releaseMonths[m - 1] + "</h3>";
								text += "<table class=\"patch-table\"><tr id=\"header-row-" + i + "-" + j + "-" + m + "\"><th class=\"patch-notes-version-col\">Version</th><th class=\"patch-notes-release-col\">Release</th><th class=\"patch-notes-type-col\">Type</th><th class=\"patch-notes-description-col\">Description</th></tr>";
								break;
							}
						}
						if(hasReleases) {
							for(var p = 0; p < releaseNotes.length; p++) {
								if(releaseNotes[p].version == releaseVersions[i] && releaseNotes[p].year == releaseYears[j] && releaseNotes[p].month == m) {
									text += "<tr id=\"patch-notes-release-" + p + "\"><td>" + releaseNotes[p].version + "</td>";
									text += "<td>" + releaseNotes[p].number + "</td>";
									if(releaseNotes[p].scriptingType == "ai") {
										text += "<td>AI</td>";
									}
									else if (releaseNotes[p].scriptingType == "rms") {
										text += "<td>RMS</td>";
									}
									else {
										text += "<td>Other</td>";
									}
									text += "<td>" + releaseNotes[p].notes;
									if (releaseNotes[p].itemsAffected.length > 0) {
										text += "<br><strong>Items Affected: </strong>";
										for(var q = 0; q < releaseNotes[p].itemsAffected.length; q++) {
											text += releaseNotes[p].itemsAffected[q].getLink();
											if (q < releaseNotes[p].itemsAffected.length - 1) {
												text += ", ";
											}
										}
									}
									text += "</td></tr>";
									num = num + 1;
								}
							}
							text += "</table>";
						}
					}
					text += "<hr id=\"year-hr-" + j + "\" class=\"patch-notes-year-hr\">";
					hasReleases = false;
				}
			}
		}
		document.getElementById("patchNotesTable").innerHTML = text;
		document.getElementById("num-results").innerHTML = "Num Results: " + num;
		
	</script>


	<script>
		function patchNotesFilter() {
			var num = 0;
			var text = "";
			var hasReleases = false;
			var notes = "";

			// Declare variables
			var input, version, year, month, type, filter, table, tr, tdVersion, tdYear, tdMonth, tdType, tdDescription, versionHeader, yearHeader, monthHeader, yearHr, i, tempText;
			input = document.getElementById("patchNotesInput");
			filter = input.value.toUpperCase();
			version = document.getElementById("patchNotesVersion");
			year = document.getElementById("patchNotesYear");
			month = document.getElementById("patchNotesMonth");
			type = document.getElementById("patchNotesType");
			tableArray = document.getElementsByTagName("table");
			versionHeader = document.getElementsByClassName("patch-notes-version");
			yearHeader = document.getElementsByClassName("patch-notes-year");
			monthHeader = document.getElementsByClassName("patch-notes-month");
			yearHr = document.getElementsByClassName("patch-notes-year-hr");
			tr = document.getElementsByTagName("tr");

			for(var j = 0; j < releaseVersions.length; j++) {
				for(i = 0; i < releaseNotes.length; i++) {
					notes = releaseNotes[i].notes.toString();
					notes = notes.toUpperCase();
					if(releaseNotes[i].version == releaseVersions[j] && (releaseNotes[i].version == version.value || version.value == "All") && notes.indexOf(filter) > -1 && (releaseNotes[i].scriptingType == type.value || type.value == "All")) {
						hasReleases = true;
						break;
					}
				}
				if(hasReleases) {
					hasReleases = false;
					for(var k = 0; k < versionHeader.length; k++) {
						if(versionHeader[k].id == "version-header-" + j) {
							versionHeader[k].style.display = "";
						}
					}
					for(var m = 0; m < releaseYears.length; m++) {
						for(i = 0; i < releaseNotes.length; i++) {
							if(releaseNotes[i].version == releaseVersions[j] && (releaseNotes[i].version == version.value || version.value == "All") && releaseNotes[i].year == releaseYears[m] && (releaseNotes[i].year == year.value || year.value == "All")) {
								hasReleases = true;
								break;
							}
						}
						if(hasReleases) {
							hasReleases = false;
							for(var n = 0; n < yearHeader.length; n++) {
								if(yearHeader[n].id == "year-header-" + m) {
									yearHeader[n].style.display = "";
								}
							}
							for(var p = 0; p < yearHr.length; p++) {
								if(yearHr[p].id == "year-hr-" + m) {
									yearHr[p].style.display = "";
								}
							}
							for(var q = releaseMonths.length - 1; q >= 0; q--) {
								for(i = 0; i < releaseNotes.length; i++) {
									if(releaseNotes[i].version == releaseVersions[j] && (releaseNotes[i].version == version.value || version.value == "All") && releaseNotes[i].year == releaseYears[m] && (releaseNotes[i].year == year.value || year.value == "All") && releaseNotes[i].month == q && (releaseNotes[i].month == month.value || month.value == "All")) {
										hasReleases = true;
										break;
									}
								}
								if(hasReleases) {
									hasReleases = false;
									for(var r = 0; r < monthHeader.length; r++) {
										if(monthHeader[r].id == "month-header-" + q) {
											monthHeader[r].style.display = "";
										}
									}
									/*tempText = "header-row-" + j + "-" + m + "-" + q;
									for(var s = 0; s < tr.length; s++) {
										if(tr[s].id == tempText) {
											tr[s].style.display = "";
										}
									}*/
								}
								else {
									for(var r = 0; r < monthHeader.length; r++) {
										if(monthHeader[r].id == "month-header-" + q) {
											monthHeader[r].style.display = "none";
										}
									}
									/*tempText = "header-row-" + j + "-" + m + "-" + q;
									for(var s = 0; s < tr.length; s++) {
										if(tr[s].id == tempText) {
											tr[s].style.display = "none";
										}
									}*/
								}
							}
						}
						else {
							for(var n = 0; n < yearHeader.length; n++) {
								if(yearHeader[n].id == "year-header-" + m) {
									yearHeader[n].style.display = "none";
								}
							}
							for(var p = 0; p < yearHr.length; p++) {
								if(yearHr[p].id == "year-hr-" + m) {
									yearHr[p].style.display = "none";
								}
							}
						}
					}
				}
				else {
					for(var k = 0; k < versionHeader.length; k++) {
						if(versionHeader[k].id == "version-header-" + j) {
							versionHeader[k].style.display = "none";
						}
					}
				}
			}

			for(i = 0; i < releaseNotes.length; i++) {
				if((releaseNotes[i].version == version.value || version.value == "All") && (releaseNotes[i].year == year.value || year.value == "All") && (releaseNotes[i].month == month.value || month.value == "All") && notes.indexOf(filter) > -1 && (releaseNotes[i].scriptingType == type.value || type.value == "All")) {
					for(var s = 0; s < tr.length; s++) {
						if(tr[s].id == "patch-notes-release-" + i) {
							tr[s].style.display = "";
						}
					}
				}
				else {
					for(var s = 0; s < tr.length; s++) {
						if(tr[s].id == "patch-notes-release-" + i) {
							tr[s].style.display = "none";
						}
					}
				}

			}

			/*num = 0;
			for (var h = 0; h < tableArray.length; h++) {
				table = document.getElementById("bldg-" + h);
				tr = table.getElementsByTagName("tr");
				header = document.getElementById("bldg-header-" + h);
				bldgNum = 0;

				//Loop through all table rows, and hide those who don't match the search query
				for (var i = 0; i < tr.length - 1; i++) {
					tdId = tableArray[h][i].id;
					tdName = tableArray[h][i].name;
					tdAiName = tableArray[h][i].aiName;
					tdClass = tableArray[h][i].class;
					tdBuilding = tableArray[h][i].building;
					tdAge = tableArray[h][i].age;
					tdAok = tableArray[h][i].aok;
					tdTc = tableArray[h][i].tc;
					tdWk = tableArray[h][i].wk;
					tdDe = tableArray[h][i].de;

					if (tdName != "" && tdId.toString().length > 0) {
						if (tdId.toString().toUpperCase().indexOf(filter) > -1 || tdName.toUpperCase().indexOf(filter) > -1 || tdAiName.toUpperCase().indexOf(filter) > -1) {
							if(objectClass == "All" || tdClass == objectClass) {
								if(building == "All" || tdBuilding == building) {
									if(age == "All" || tdAge == age) {
										if(version == "All" || (version == "AoK" && tdAok == 1) || (version == "TC" && tdTc == 1) || (version == "WK" && tdWk == 1) || (version == "DE" && tdDe == 1)) {
											tr[i + 1].style.display = "";
											num = num + 1;
											bldgNum = bldgNum + 1;
										}
										else {
											tr[i + 1].style.display = "none";
										}
									}
									else {
										tr[i + 1].style.display = "none";
									}
								}
								else {
									tr[i + 1].style.display = "none";
								}
							}
							else {
								tr[i + 1].style.display = "none";
							}
						}
						else {
							tr[i + 1].style.display = "none";
						}
					}
				}
				if (bldgNum == 0) {
					header.style.display = "none";
					tr[0].style.display = "none";
				}
				else {
					header.style.display = "";
					tr[0].style.display = "";
				}
			}
			document.getElementById("num-results").innerHTML = "Num Results: " + num;*/
		}
	</script>

</body>
</html>