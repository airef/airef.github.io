<!DOCTYPE html>
<html>
<head>
	<title>Userpatch Patch Notes</title>
	<meta charset="utf-8"/>
	<link rel="stylesheet" type="text/css" href="../../css/style.css">
	<link rel="stylesheet" type="text/css" href="../../jqueryui/jquery-ui.min.css">
	<link rel="stylesheet" type="text/css" href="../../jqueryui/jquery-ui.structure.min.css">
	<link rel="stylesheet" type="text/css" href="../../jqueryui/jquery-ui.theme.min.css">
	<link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css2?family=Crimson+Text&display=swap" rel="stylesheet"> 
    <link rel="icon" type="image/png" href="../../../favicon.png">
</head>

<body>

	<div class="container">
		<div id="nav-placeholder"></div>
		<h2>Userpatch Patch Notes</h2><p>
			<label for="patchNotesInput" class="patch-notes-input-label">Search</label>
			<label for="patchNotesVersion" class="dropdown-label">Version</label>
			<label for="patchNotesYear" class="dropdown-label">Year</label>
			<label for="patchNotesMonth" class="dropdown-label">Month</label>
			<label for="patchNotesType" class="dropdown-label">Release Type</label>
			<input type="text" id="patchNotesInput" onkeyup="patchNotesFilter()" placeholder="Search patch notes..." autocomplete="off" autofocus="autofocus">
			<select id="patchNotesVersion" class="drop-filter" onchange="patchNotesFilter()" autocomplete="off" title="UP Version">
				<option value="All" selected>All</option>
				<option value="1.1">1.1</option>
				<option value="1.2">1.2</option>
				<option value="1.3">1.3</option>
				<option value="1.4">1.4</option>
				<option value="1.5">1.5</option>
			</select>
			<select id="patchNotesYear" class="drop-filter" onchange="patchNotesFilter()" autocomplete="off" title="Year">
				<option value="All" selected>All</option>
				<option value="2011">2011</option>
				<option value="2012">2012</option>
				<option value="2013">2013</option>
				<option value="2014">2014</option>
				<option value="2015">2015</option>
				<option value="2016">2016</option>
				<option value="2017">2017</option>
				<option value="2018">2018</option>
				<option value="2019">2019</option>
			</select>
			<select id="patchNotesMonth" class="drop-filter" onchange="patchNotesFilter()" autocomplete="off" title="Month">
				<option value="All" selected>All</option>
				<option value="1">January</option>
				<option value="2">February</option>
				<option value="3">March</option>
				<option value="4">April</option>
				<option value="5">May</option>
				<option value="6">June</option>
				<option value="7">July</option>
				<option value="8">August</option>
				<option value="9">September</option>
				<option value="10">October</option>
				<option value="11">November</option>
				<option value="12">December</option>
			</select>
			<select id="patchNotesType" class="drop-filter" onchange="patchNotesFilter()" autocomplete="off" title="Scripting Type">
				<option value="All" selected>All</option>
				<option value="ai">AI</option>
				<option value="rms">RMS</option>
				<option value="other">Other</option>
			</select>
		</p>
		<p id="num-results"></p>
		<p id="patchNotesTable"></p>
		<div id="footer-placeholder"></div>
	</div>
	
	<script>
		var urlPrefix = "../.."; //this adds a prefix to all reference links so the link knows the path to the home directory
		var currPage = "resources";
	</script>
	<script src="../../js/upreleases.js"></script>
	<script src="../../js/nav.js"></script>
	<script src="../../js/jquery.js"></script>
	<script src="../../jqueryui/jquery-ui.min.js"></script>

	<script>
		function patchNotesFilter() {
			var num = 0;
			var text = "";
			var tempText = "";
			var tempMonthText = "";
			var tempYearText = "";
			var tempVersionText = "";
			var hasReleases = false;
			var currVersion = false;
			var currYear = false;
			var currMonth = false;

			// Declare variables
			var input, version, year, month, type, filter
			input = document.getElementById("patchNotesInput");
			version = document.getElementById("patchNotesVersion");
			year = document.getElementById("patchNotesYear");
			month = document.getElementById("patchNotesMonth");
			type = document.getElementById("patchNotesType");
			filter = input.value.toUpperCase();
			var notes = "";

			
			/*text += "<h2 id=\"version-header-" + i + "\" class=\"patch-notes-header, patch-notes-version\">Version " + releaseVersions[i] + "</h2>";


			for(var q = 0; q < releaseNotes.length; q++) {
								if(releaseNotes[q].version == releaseVersions[i] && releaseNotes[q].year == releaseYears[j]) {
									hasReleases = true;
									text += "<h3 id=\"year-header-" + i + "\" class=\"patch-notes-header, patch-notes-year\">" + releaseYears[j] + "</h3>";
									break;
								}
							}
							if (hasReleases) {
								hasReleases = false
								
								
											text += "<h3 id=\"month-header-" + i + "\" class=\"patch-notes-header, patch-notes-month\">" + releaseMonths[k - 1] + "</h3>";
											text += "<table class=\"patch-table\"><tr><th class=\"patch-notes-version-col\">Version</th><th class=\"patch-notes-release-col\">Release</th><th class=\"patch-notes-type-col\">Type</th><th class=\"patch-notes-description-col\">Description</th></tr>";
											break;*/

			for(var i = 0; i < releaseVersions.length; i++) {
				if(version.value == releaseVersions[i] || version.value == "All") {
					currVersion = false;
					for(var j = 0; j < releaseYears.length; j++) {
						if(year.value == releaseYears[j] || year.value == "All") {
							currYear = false;
							for(var k = releaseMonths.length - 1; k >= 0; k--) {
								if(month.value == k || month.value == "All") {
									currMonth = false;
									for(var p = 0; p < releaseNotes.length; p++) {
										notes = releaseNotes[p].notes.toString();
										notes = notes.toUpperCase();
										if(releaseNotes[p].version == releaseVersions[i] && releaseNotes[p].year == releaseYears[j] && releaseNotes[p].month == k && notes.indexOf(filter) > -1 && (releaseNotes[p].scriptingType == type.value || type.value == "All")) {
											currMonth = true;
											currYear = true;
											currVersion = true;
											tempText += "<tr><td>" + releaseNotes[p].version + "</td>";
											tempText += "<td>" + releaseNotes[p].number + "</td>";
											if(releaseNotes[p].scriptingType == "ai") {
												tempText += "<td>AI</td>";
											}
											else if (releaseNotes[p].scriptingType == "rms") {
												tempText += "<td>RMS</td>";
											}
											else {
												tempText += "<td>Other</td>";
											}
											tempText += "<td>" + releaseNotes[p].notes;
											if (releaseNotes[p].itemsAffected.length > 0) {
												tempText += "<br><strong>Items Affected: </strong>";
												for(var n = 0; n < releaseNotes[p].itemsAffected.length; n++) {
													tempText += releaseNotes[p].itemsAffected[n].getLink();
													if (n < releaseNotes[p].itemsAffected.length - 1) {
														tempText += ", ";
													}
												}
											}
											tempText += "</td></tr>";
											num = num + 1;
										}
									}
									if(currMonth) {
										tempMonthText += "<h3 id=\"month-header-" + i + "\" class=\"patch-notes-header, patch-notes-month\">" + releaseMonths[k - 1] + "</h3>";
										tempMonthText += "<table class=\"patch-table\"><tr><th class=\"patch-notes-version-col\">Version</th><th class=\"patch-notes-release-col\">Release</th><th class=\"patch-notes-type-col\">Type</th><th class=\"patch-notes-description-col\">Description</th></tr>";
										tempMonthText += tempText;
										tempMonthText += "</table>";
										tempText = "";
									}
								}
							}
							if(currYear) {
								tempYearText += "<h3 id=\"year-header-" + i + "\" class=\"patch-notes-header, patch-notes-year\">" + releaseYears[j] + "</h3>";
								tempYearText += tempMonthText;
								tempYearText += "<hr>";
								tempMonthText = "";
							}
						}
					}
					if(currVersion) {
						tempVersionText += "<h2 id=\"version-header-" + i + "\" class=\"patch-notes-header, patch-notes-version\">Version " + releaseVersions[i] + "</h2>";
						tempVersionText += tempYearText;
						text += tempVersionText;
						tempVersionText = ""; 
						tempYearText = "";
					}
				}
			}

			document.getElementById("patchNotesTable").innerHTML = text;
			document.getElementById("num-results").innerHTML = "Num Results: " + num;
		}
	</script>

<script>
	patchNotesFilter()
</script>

</body>
</html>